# Casbin RBAC Model Configuration
# Supports roles: owner, admin, editor, viewer

[request_definition]
r = sub, obj, act

[policy_definition]
p = sub, obj, act

[role_definition]
g = _, _

[policy_effect]
e = some(where (p.eft == allow))

[matchers]
m = g(r.sub, p.sub) && r.obj == p.obj && r.act == p.act

# Organization-level permissions
[policy]
# Owner has full access to everything
p, owner, organizations, read
p, owner, organizations, write
p, owner, organizations, delete
p, owner, users, read
p, owner, users, write
p, owner, users, delete
p, owner, memberships, read
p, owner, memberships, write
p, owner, memberships, delete
p, owner, projects, read
p, owner, projects, write
p, owner, projects, delete
p, owner, jobs, read
p, owner, jobs, write
p, owner, jobs, delete
p, owner, resumes, read
p, owner, resumes, write
p, owner, resumes, delete
p, owner, variants, read
p, owner, variants, write
p, owner, variants, delete
p, owner, cover-letters, read
p, owner, cover-letters, write
p, owner, cover-letters, delete
p, owner, exports, read
p, owner, exports, write
p, owner, exports, delete
p, owner, assets, read
p, owner, assets, write
p, owner, assets, delete
p, owner, comments, read
p, owner, comments, write
p, owner, comments, delete

# Admin has most permissions except organization deletion
p, admin, organizations, read
p, admin, organizations, write
p, admin, users, read
p, admin, users, write
p, admin, memberships, read
p, admin, memberships, write
p, admin, projects, read
p, admin, projects, write
p, admin, projects, delete
p, admin, jobs, read
p, admin, jobs, write
p, admin, jobs, delete
p, admin, resumes, read
p, admin, resumes, write
p, admin, resumes, delete
p, admin, variants, read
p, admin, variants, write
p, admin, variants, delete
p, admin, cover-letters, read
p, admin, cover-letters, write
p, admin, cover-letters, delete
p, admin, exports, read
p, admin, exports, write
p, admin, exports, delete
p, admin, assets, read
p, admin, assets, write
p, admin, assets, delete
p, admin, comments, read
p, admin, comments, write
p, admin, comments, delete

# Editor can create and edit content but not delete organizations/users
p, editor, organizations, read
p, editor, users, read
p, editor, memberships, read
p, editor, projects, read
p, editor, projects, write
p, editor, jobs, read
p, editor, jobs, write
p, editor, resumes, read
p, editor, resumes, write
p, editor, variants, read
p, editor, variants, write
p, editor, cover-letters, read
p, editor, cover-letters, write
p, editor, exports, read
p, editor, exports, write
p, editor, assets, read
p, editor, assets, write
p, editor, comments, read
p, editor, comments, write

# Viewer has read-only access
p, viewer, organizations, read
p, viewer, users, read
p, viewer, memberships, read
p, viewer, projects, read
p, viewer, jobs, read
p, viewer, resumes, read
p, viewer, variants, read
p, viewer, cover-letters, read
p, viewer, exports, read
p, viewer, assets, read
p, viewer, comments, read
